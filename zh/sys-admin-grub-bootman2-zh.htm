<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>sidux Manuals - Boot Managers</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style type="text/css" media="all">@import url("../lib/css-js/content.css");</style>
        <style type="text/css" media="all">@import url("../lib/css-js/menu.css");</style>
        <style type="text/css" media="print">@import url("../lib/css-js/print.css");</style>
        <link rel ="shortcut icon" href="../lib/favicon/manual.ico" />
        <script type="text/javascript" src="../lib/css-js/menu2.js"></script>
        <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-7_override.css">
        <![endif]-->
        <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" href="../lib/css-js/ie_5-6_override.css">
        <![endif]-->
</head>
<body>
<!-- Last translation revision by bluewater 09/01/2008 0700 UTC -->
<div id="menu"> <!-- menu starts here zh lang maintainer plmday-->
<!--sidux-manual Operating System Manual menu-version-01.96.2009.11.22 -->
<!-- menu last updated by bluewater 2009.11.22 0500 hrs UTC -->
	<div id="menu-header">
	      <a href="http://sidux.com/"><img src="../lib/logos/manual-sidux-logo.png" title="去sidux.com论坛及维基" alt="sidux.com logo" /></a>
	</div>
  	<ul id="top-list">
    		<li><a href="manual-search-zh.htm#search-on"> <img src="../lib/logos/manual-search-22x22.png" title="搜索该指南" alt="Search" />在线－离线搜索</a> </li>
    		<li><a href="http://manual.sidux.com/meta-manual">Community Software Selections</a></li>
  	</ul>
  	<div id="flags-2">
      			<a href="../flag-index.html"><img src="../lib/logos/sidux-language-64.png" title="选择另一种语言" alt="lang-switch"/></a>
  	</div>
  	<ul>
    		<li  onmouseover="showHide( 1 );" onmouseout="startTime();"><a href="welcome-zh.htm">sidux OS手册</a>
      			<ul class="sub-menu" id="sm1">
        			<li><a href="welcome-zh.htm#welcome-gen">sidux OS手册</a></li>
        			<li><a href="welcome-zh.htm#how-to">如何使用该手册</a></li>
        			<li><a href="welcome-zh.htm#table-contents">目录</a></li>
        			<li><a href="help-zh.htm#help-gen">何处获取帮助</a></li>
        			<li><a href="help-zh.htm#paste">IRC !paste</a></li>
        			<li><a href="credits-zh.htm#cred-team">功绩簿</a></li>
        			<li><a href="wel-quickstart-zh.htm#welcome-quick">sidux快速上手指南</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 2 );" onmouseout="startTime();"><a href="cd-dl-burning-zh.htm">ISO Content, Releases, Download Mirrors and Burning</a>
      			<ul class="sub-menu" id="sm2">
       			<li><a href="cd-content-zh.htm#cd-content">ISO Content and system requirements</a></li>
        			<li><a href="sys-admin-release-zh.htm#rolling">滚动升级注意事项</a></li>
        			<li><a href="cd-dl-burning-zh.htm#download-sidux">sidux镜像，下载及刻录</a></li>
        			<li><a href="cd-dl-burning-zh.htm#md5">md5校验和</a></li>
        			<li><a href="cd-dl-burning-zh.htm#burn-nero">Windows下刻录</a></li>
        			<li><a href="cd-dl-burning-zh.htm#burn-linux">Linux下刻录</a></li>
       			 	<li><a href="cd-no-gui-burn-zh.htm#burning-no-gui">无GUI刻录</a></li>
				<li><a href="cd-no-gui-burn-zh.htm#burn-no-gui-gen">Burning without a GUI</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 3 );" onmouseout="startTime();"><a href="live-mode-zh.htm">Live模式</a>
      			<ul class="sub-menu" id="sm3">
        			<li><a href="live-mode-zh.htm#rootpw">sidux-Live ISO 上的root用户密码</a></li>
        			<li><a href="live-mode-zh.htm#live-cd-installsoft">在Live- ISO 运行时安装软件</a></li>
        			<li><a href="live-mode-zh.htm#ntfs-3g">通过ntfs-3g写NTFS分区</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 4 );" onmouseout="startTime();"><a href="term-konsole-zh.htm">终端／Konsole</a>
      			<ul class="sub-menu" id="sm4">
        			<li><a href="term-konsole-zh.htm#sux"> sux / sudo</a></li>
        			<li><a href="term-konsole-zh.htm#term-kon">终端／Konsole</a></li>
        			<li><a href="term-konsole-zh.htm#cli-help">命令行帮助</a></li>
				<li><a href="help-zh.htm#init3-tools">Tools to know in text mode (tty) - init 3</a></li>
        			<li><a href="term-konsole-zh.htm#term-cmds">Linux终端命令表</a></li>
        			<li><a href="term-konsole-zh.htm#shell-scripts">安装.sh脚本</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 5 );" onmouseout="startTime();"><a href="cheatcodes-zh.htm">参数</a>
      			<ul class="sub-menu" id="sm5">
        			<li><a href="cheatcodes-zh.htm#cheatcodes">sidux特有的Live- ISO 参数</a></li>
        			<li><a href="cheatcodes-zh.htm#cheatcodes-linux">Linux惯常参数</a></li>
        			<li><a href="cheatcodes-vga-zh.htm#vga">VGA参数</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 6 );" onmouseout="startTime();"><a href="part-gparted-zh.htm">对你的硬驱进行分区</a>
      			<ul class="sub-menu" id="sm6">
        			<li><a href="part-gparted-zh.htm#partition">用GParted对你的HD进行分区</a></li>
        			<li><a href="part-gparted-zh.htm#ntfs">用GParted调整NTFS分区的大小</a></li>
        			<li><a href="part-uuid-zh.htm#uuid">UUID, 分区标记及fstab</a></li>
        			<li><a href="part-cfdisk-zh.htm#disknames">磁盘命名简介</a></li>
        			<li><a href="part-cfdisk-zh.htm#partition">用cfdisk对你的HD进行分区</a></li>
        			<li><a href="part-cfdisk-zh.htm#formating">用cfdisk分区后进行格式化</a></li>
        			<li><a href="part-size-examp-zh.htm#part-example">分区大小实例</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 7 );" onmouseout="startTime();"><a href="hd-install-zh.htm">安装选项</a>
      			<ul class="sub-menu" id="sm7">
        			<li><a href="hd-install-zh.htm#Inst-prep">安装准备</a></li>
        			<li><a href="hd-install-zh.htm#Installation">安装到你的硬盘</a></li>
        			<li><a href="hd-install-zh.htm#first-hd-boot">第一次启动</a></li>
        			<li><a href="hd-install-opts-zh.htm#fromiso">利用‘fromiso’参数从ISO文件引导</a></li>
        			<li><a href="hd-install-opts-zh.htm#fromiso-persist">fromiso与persist</a></li>
        			<li><a href="hd-install-opts-zh.htm#usb-hd">在移动硬盘上安装</a></li>
        			<li><a href="hd-install-opts-zh.htm#vtbox">通过VirtualBox安装sidux</a></li>
        			<li><a href="hd-install-opts-zh.htm#qemu">通过QEMU安装sidux</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 8 );" onmouseout="startTime();"><a href="hw-dev-hw-dri-zh.htm">图形显卡，显示屏， &amp; 驱动器杂烩</a>
      			<ul class="sub-menu" id="sm8">
        			<li><a href="hw-dev-hw-dri-zh.htm#hd-ntfs3g">通过ntfs-3g在NTFS分区上执行写操作</a></li>
        			<li><a href="hw-dev-mon-zh.htm#mon-res">屏幕像素与显示屏</a></li>
        			<li><a href="hw-dev-mon-zh.htm#xrandr">双显示屏及xrandr</a></li>
        			<li><a href="hw-dev-mon-zh.htm#mon-binary">双显示屏（用二进制格式的驱动器）</a></li>
				<li><a href="hw-dev-hw-dri-zh.htm#non-free-3d">Binary, non-free drivers for Nvidia</a></li>
				<li><a href="hw-dev-hw-dri-zh.htm#non-free-3d-2">non-free drivers for ATI, Radeon and others</a></li>
				<li><a href="hw-dev-hw-dri-zh.htm#non-free-firmware">Hardware needing non-free firmware drivers</a></li>
				<li><a href="hw-dev-hw-dri-zh.htm#non-free">Adding non-free to Sources List</a></li>
				<li><a href="hw-dev-hw-dri-zh.htm#native-nv-ati">FOSS xorg drivers for nVidia, ATI, Radeon, Intel</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 9 );" onmouseout="startTime();"><a href="wm-kde-zh.htm">窗口管理器</a>
     			 <ul class="sub-menu" id="sm9">
				<li><a href="wm-xfce-zh.htm#xfce-notes">Useful Xfce extras</a></li>
				<li><a href="wm-kde-zh.htm#install-add">Useful extra KDE Apps</a></li>
        			<li><a href="wm-kde-zh.htm#desk-freeze">桌面冻结</a></li>
        			<li><a href="wm-kde-zh.htm#kde-login">无法登入KDE</a></li>
        			<li><a href="wm-kde-zh.htm#ch-th">更换主题</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 10 );" onmouseout="startTime();"><a href="lamp-apache-zh.htm">sidux LAMP栈</a>
      			<ul class="sub-menu" id="sm10">
        			<li><a href="lamp-apache-zh.htm#serv-apache">sidux LAMP栈</a></li>
        			<li><a href="lamp-apache-zh.htm#serv-ftp">FTP客户端</a></li>
        			<li><a href="lamp-apache-zh.htm#serv-sec">安全协议</a></li>
        			<li><a href="lamp-apache-zh.htm#serv-ssl">SSL</a></li>
        			<li><a href="lamp-sql-zh.htm#serv-mysql">MySQL配置</a></li>
        			<li><a href="lamp-ppp-zh.htm#serv-php">Apache里用PHP</a></li>
        			<li><a href="ntp-server-zh.htm#ntp-server">时钟服务器配置</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 11 );" onmouseout="startTime();"><a href="internet-connecting-zh.htm">因特网及连网</a>
      			<ul class="sub-menu" id="sm11">
        			<li><a href="tor-privoxy-zh.htm#tor">Tor</a></li>
        			<li><a href="tor-privoxy-zh.htm#privoxy">Privoxy</a></li>
        			<li><a href="internet-connecting-zh.htm#firewalls">防火墙</a></li>
        			<li><a href="samba-zh.htm#configure">设置SAMBA（Windows）</a></li>
        			<li><a href="samba-zh.htm#setup">Samba服务器配置</a></li>
        			<li><a href="ssh-zh.htm#ssh-fs">SSH远程挂载</a></li>
        			<li><a href="ssh-zh.htm#ssh-x">透过SSH运行X窗口应用程序</a></li>
        			<li><a href="ssh-zh.htm#ssh-f">通过Konqueror用GUI化的SSH</a></li>
        			<li><a href="ssh-zh.htm#ssh-w">从Windows-PC通过X转发用SSH</a></li>
        			<li><a href="ssh-zh.htm#ssh">SSH与安全</a></li>
        			<li><a href="internet-connecting-zh.htm#dial-mod">56k调制解调器</a></li>
        			<li><a href="internet-connecting-wpagui-zh.htm#wpa-roaming-gui">WiFi－漫游的WPA-GUI</a></li>
        			<li><a href="internet-connecting-wpa-zh.htm#wpa-basic">WiFi－基本配置指南</a></li>
        			<li><a href="internet-connecting-wpa-zh.htm#wpa">WiFi－wpasupplicant</a></li>
        			<li><a href="internet-connecting-zh.htm#netcardconfig">上线－Ceni</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 12 );" onmouseout="startTime();"><a href="sys-admin-apt-zh.htm">dist-upgrade and package management</a>
      			<ul class="sub-menu" id="sm12">
        			<li><a href="sys-admin-apt-zh.htm#apt-cook">APT指南秘笈与源表</a></li>
        			<li><a href="sys-admin-apt-zh.htm#apt-install">安装一个新的软件包</a></li>
        			<li><a href="sys-admin-apt-zh.htm#apt-delete">删除一个软件包</a></li>
        			<li><a href="sys-admin-apt-zh.htm#apt-downgrade">软件包隔离与降级</a></li>
        			<li><a href="sys-admin-apt-zh.htm#apt-cache">通过apt-cache搜索软件包</a></li>
        			<li><a href="sys-admin-apt-zh.htm#gui-pacsea">GUI Package searching</a></li>
        			<li><a href="siduxcc-zh.htm#hermes">sidux-hermes</a></li>
        			<li><a href="sys-admin-upgrade-zh.htm#live-cd-upgrade">用Live- ISO 升级</a></li>
				<li><a href="sys-admin-apt-locarmirr-zh.htm#approx">dist-upgrade of multiple PCs on a LAN</a></li>
        			<li><a href="sys-admin-kern-upg-zh.htm#kern-upgrade">升级内核</a></li>
        			<li><a href="sys-admin-apt-zh.htm#apt-upgrade">升级已安装的系统－dist-upgrade - Overview</a></li>
				<li><a href="sys-admin-apt-zh.htm#du-st">升级已安装的系统－dist-upgrade - The Steps</a></li>
      			</ul>
    		</li>
    		<li  onmouseover="showHide( 13 );" onmouseout="startTime();"><a href="sys-admin-gen-zh.htm">系统管理</a>
      			<ul class="sub-menu" id="sm13">
				<li><a href="hd-install-ezh.htm#adduser">Adding a new user</a></li>
        			<li><a href="home-zh.htm#home-bu">移动/home</a></li>
        			<li><a href="siduxcc-zh.htm#siduxcc">sidux控制中心</a></li>
        			<li><a href="sys-admin-rdiff-zh.htm#rdiff">用rdiff备份</a></li>
        			<li><a href="sys-admin-rsync-zh.htm#rsync">用rsync备份</a></li>
        			<li><a href="vir-rkits-zh.htm#virus-rkits">病毒和刨根工具扫描程序</a></li>
        			<li><a href="sys-admin-gen-zh.htm#start-services">启用／停用服务</a></li>
        			<li><a href="sys-admin-gen-zh.htm#pw-lost">遗失root用户密码</a></li>
        			<li><a href="sys-admin-gen-zh.htm#fonts">字体</a></li>
        			<li><a href="sys-admin-gen-zh.htm#cups">CUPS - Printing System</a></li>
				<li><a href="sys-admin-gen-zh.htm#sound">Sound Mixers</a></li>
        			<li><a href="sys-admin-gen-zh.htm#init">sidux运行段位－init</a></li>
        			<li><a href="sys-admin-grub-bootman2-zh.htm#mbr-grub-boot">MBR覆写引导扇区</a></li>
        			<li><a href="sys-admin-grub-bootman2-zh.htm#dual-boot">双启动或多启动</a></li>
        			<li><a href="bios-freedos-zh.htm#bois-prep">通过FreeDOS升级BIOS</a></li>
        			<li><a href="sys-admin-grub-bootman2-zh.htm#boot-grub-floppy">创建一张引导软盘</a></li>
        			<li><a href="sys-admin-grub-bootman2-zh.htm#remove-grub">从MBR移除grub</a></li>
        			<li><a href="sys-admin-grub-bootman2-zh.htm#what-is-grub">Grub引导管理器</a></li>
      			</ul>
    		</li>
  	</ul>
<!-- menu ends here --> </div>
<div id="main-page">
	<div class="divider" id="mbr-grub-boot">

					<h2 id="top-header">To rewrite Grub1 (grub-legacy)</h2>
						<p><span class="highlight-2">NOTE: to restore a Grub1 bootloader you need to have a 2009-03 (momos) sidux.iso or earlier.</span></p>

						<p>To only re-write grub (grub-legacy) to MBR from the hard drive:</p>
<pre>
/usr/sbin/grub-install --recheck --no-floppy /dev/sda
</pre>
						<p>This line may need to be run more than once, until its convinced you really mean it.</p>

		<h2>Bootsector overwritten by Windows MBR and /or to recover grub1 (grub-legacy)</h2>
							<p><span class="highlight-2">NOTE: to restore a Grub1 bootloader you need to have a 2009-03 (momos) sidux.iso or earlier.</span> <a href="sys-admin-grub2-zh.htm#chroot">Alternatively use chroot with any live.iso</a>.</p>

							<p> To rewrite the grub (grub-legacy) to the MBR and/or to recover grub 1 in general, you will need boot up a <span class="highlight-3">sidux live-cd (sidux-2009-03-momos.iso or earlier)</span>, first:</p>
						<ol>
							<li>To identify and confirm your partitions (e.g. [h,s]d[a..]X) all the following actions need root privileges, so to get root (#):
<pre>
$ sux
</pre>
							</li>
							<li>When in root type in:
<pre>
fdisk -l
cat /etc/fstab
</pre>
							This is to get the correct names.
							</li>
							<li>When you have acertained the correct partition, create the mount point:
<pre>
mkdir -p /media/[hdxx,sdxx,diskx]
</pre>
							</li>
							<li>Mount it:
<pre>
mount /dev/xdxx /media/xdxx
</pre>
							</li>

							<li>Now rewrite Grub to MBR of the first harddisk (generic):
<pre>
/usr/sbin/grub-install --recheck --no-floppy --root-directory=/media/xdxx /dev/sda
</pre>
							</li>
						</ol>

					<h6>Example</h6>
<pre>
root@sidux:/home/sidux# fdisk -l
# fdisk -l
Disk /dev/sda: 115.9 GB, 115989736960 bytes
255 heads, 63 sectors/track, 14101 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
Disk identifier: 0x40444044
   Device Boot      Start         End      Blocks   Id  System
/dev/sda1   *           1        3673    29503341    7  HPFS/NTFS
/dev/sda2            3674       14101    83762910    5  Extended
/dev/sda5            3674        7239    28641784+  83  Linux
/dev/sda6            7239       10842    28934104+  83  Linux
/dev/sda7           10843       14101    26177886    b  W95 FAT32
Disk /dev/sdb: 120.0 GB, 120034123776 bytes
255 heads, 63 sectors/track, 14593 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
Disk identifier: 0xa41e667f
   Device Boot      Start         End      Blocks   Id  System
/dev/sdb1               1        3574    28708123+  83  Linux
/dev/sdb2            3575        7247    29503372+  83  Linux
/dev/sdb3            7248       10845    28900935   83  Linux
/dev/sdb4           10846       14593    30105810    5  Extended
/dev/sdb5   *       10846       14338    28057491   83  Linux
/dev/sdb6           14339       14593     2048256   82  Linux swap / Solaris
Disk /dev/sdc: 250.0 GB, 250059350016 bytes
255 heads, 63 sectors/track, 30401 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
Disk identifier: 0x00077541
   Device Boot      Start         End      Blocks   Id  System
/dev/sdc1               1       30401   244196001   83  Linux
Disk /dev/sdd: 250.0 GB, 250059350016 bytes
255 heads, 63 sectors/track, 30401 cylinders
Units = cylinders of 16065 * 512 = 8225280 bytes
Disk identifier: 0x1c01ad92
   Device Boot      Start         End      Blocks   Id  System
/dev/sdd1               1       30401   244196001   83  Linux

root@sidux:/home/sidux# cat /etc/fstab
# /etc/fstab - static information about the filesystems - fstab(5)
#
# /etc/fstab is only read by programs, and not written; it is the duty of the
# system administrator to properly maintain this file.
#
# Instead  of giving the device explicitly, one may indicate the filesystem
# that is to be mounted by its UUID or VOLUME label. This will make the
# system more robust: adding or removing a disk changes the disk device name
# but not the filesystem UUID or VOLUME label.

# automatically added, ST3120026A-3LJ093B4-part1
/dev/sda1       /media/disk0    ntfs    noauto,users,exec,ro,dmask=0022,fmask=0133      0       0

# automatically added, ST3120026A-3LJ093B4-part5
/dev/sda5       /media/disk1    jfs     noauto,users,exec,relatime       0       2

# automatically added, ST3120026A-3LJ093B4-part6
/dev/sda6       /media/disk2    reiserfs        noauto,users,exec,relatime       0       2

# automatically added, ST3120026A-3LJ093B4-part7
/dev/sda7       /media/disk3    vfat    noauto,users,exec,shortname=lower,quiet,umask=000       0       0

# automatically added, ST3120026A-3LJ09RBF-part1
/dev/sdb1       /media/disk4    reiserfs        noauto,users,exec,relatime       0       2

# automatically added, ST3120026A-3LJ09RBF-part2
/dev/sdb2       /media/disk5    ext3    noauto,users,exec,relatime       0       2

# automatically added, ST3120026A-3LJ09RBF-part3
/dev/sdb3       /media/disk6    reiserfs        noauto,users,exec,relatime       0       2

# automatically added, ST3120026A-3LJ09RBF-part5
/dev/sdb5       /media/disk7    ext3    noauto,users,exec,relatime       0       2

# automatically added, ST3120026A-3LJ09RBF-part6
/dev/sdb6       none    swap    sw      0       0

# automatically added, ST3250824AS-4ND1V199-part1
/dev/sdc1       /media/disk9    ext3    noauto,users,exec,relatime       0       2

# automatically added, ST3250620AS-9QE13XVF-part1
/dev/sdd1       /media/disk10   ext3    noauto,users,exec,relatime       0       2

# automatically added, _NEC_DVD_RW_ND-4550A
/dev/cdrom      /media/cdrom    udf,iso9660     user,noauto     0       0

# automatically added, ASUS_DVD-ROM_DVD-E616P_0104
/dev/cdrom1     /media/cdrom1   udf,iso9660     user,noauto     0       0

# automatically added
/dev/fd0        /media/fd0      auto    rw,user,noauto  0       0

# temporary filesystem in virtual memory
#tmpfs  /tmp    tmpfs   defaults        0       0
</pre>
<pre>
root partition is /dev/sdb1  and your MBR goes on sda
mkdir -p /media/sdb1
mount /dev/sdb1 /media/sdb1
/usr/sbin/grub-install --recheck --no-floppy --root-directory=/media/sdb1 /dev/sda
</pre>


						<p>On older linux systems, the IDE disks devices (PATA) were differentiated from those using current standard by an <span class="highlight-3">hdaX</span> name instead of<span class="highlight-3"> sdaX</span></p>



	</div>
	<div class="divider" id="boot-grub-floppy">
		<h2>Creating a bootable Floppy</h2>


							<p>To make yourself a boot floppy, use the tools provided in <a href="http://www.ultimatebootcd.com/">UBCD (Ultimate Boot Disk CD)</a></p>


	</div>
	<div class="divider" id="remove-grub">
		<h2>Removing grub from MBR</h2>

							<p>Install the system recovery tool mbr:</p>
<pre>
apt-get update
apt-get install mbr
apt-get remove --purge lilo
man install-mbr
</pre>

	</div>
	<div class="divider" id="what-is-grub">
		<h2>GRUB the Boot Manager - what it is</h2>

			<h3>General</h3>
<pre>
<span class="highlight-3">NOTE Grub for kernels 2.6.22 and up uses sdax
and the line
initrd (hd0.x)/sidux/miniroot.gz
has changed to:
initrd		/boot/initrd.img-2.6.xx.x-slh-smp-x</span>
</pre>
							<p>Grub is a boot manager that can boot operating systems from different partitions. Grub does not rely on block lists to find the needed files for a system to start up, and it can read many file-systems by default: ext2, ext3, reiserfs, ... (Linux), Fat32, Fat16 (MS Windows (TM)), UFS (BSD), Minix and many others.</p>

							<p>Grub knows BIOS-extensions (meaning it can boot partitions above 8 GByte!) and has no 1024-cylinder-barrier. Grub doesn't really care, where the kernel physically resides, all it needs is the declaration of the partition and the path to the kernel it's supposed to boot (this can even be a symlink). After a change in the configuration (i.e. the menu.lst) it doesn't need a program-call like Lilo does, the new configuration is applied at next boot.</p>

							<p>sidux uses Grub to boot from CD, and when installing to harddisk, Grub is used by default. Nonetheless Grub can be installed afterwards without a problem. Grub is installed to the MBR from a root-shell with the following command:</p>


<pre>
grub-install --root-directory=/media/hdaX /dev/hdY
</pre>

							<p>/media/hdaX stands for the readable-mounted partition, on which, in the directory "/boot/grub" the necessary files (stage2, stage1_5xxx) will be placed. The configuration file "menu.lst" must also be created in that directory. /dev/hdY is the harddisk, in whose MBR Grub will be installed, normally /dev/hda.</p>

						<h3>Drivenames/Devicenames</h3>

							<p><span class="highlight-2">Please Note: </span><span class="highlight-3">hda</span> is in the process of being depreciated, therefore you need to start substituting <span class="highlight-3">hda </span>with <span class="highlight-3">sda</span> for kernels 2.6.22 and onward.</p>

							<p>Grub does not differentiate between SCSI- and IDE-Harddisks. (hd0) is always the first hard disk that is first in the boot sequence (setting in BIOS), no matter if IDE or SCSI. Unusual is the counting method; the first partition on the first hd is (hd0,0). Primary partitions are numbered from 0-3, logical partitions count from 4 on up.</p>

		<table>
			<tbody>
				<tr>
					<th><b>Grub</b></th>
					<th><b>Linux</b></th>
					<th><b>Label</b></th>
				</tr>
				<tr>
					<td>(fd0)</td>
					<td>/dev/fd0</td>
					<td>Floppy (under Windows)</td>
				</tr>
				<tr>
					<td>(hd0)</td>
					<td>/dev/hda</td>
					<td>first hd</td>
				</tr>
				<tr>
					<td>(hd0,0)</td>
					<td>/dev/hda1</td>
					<td>Part.1 on hd1</td>
				</tr>
				<tr>
					<td>(hd0,5)</td>
					<td>/dev/hda6</td>
					<td>Logical part. on hd 1</td>
				</tr>
			</tbody>
		</table>
	<div class="spacer05"></div>
							<p>All nominations for devices for Grub are to be put in brackets (). Be aware of the entries behind the Kernel-line though. In contrast to Grub the Kernel needs the data in the normal linux way. The entries in the following example both point to the same partition, namely the fourth partition on the first hd. The first line is in Grub notation, the second one in typical linux notation:</p>
<pre>
root (hd0,3)
kernel          /boot/vmlinuz root=UUID=bf955abf-ce1f-45a3-9ee5-93b5c5dc4fe0 ro quiet vga=791
initrd          /boot/initrd.img
</pre>

					<h3>Command-Mode (Grub-Shell)</h3>

							<p>A very comfortable feature is the Command-Mode. It is accessed by "c", and here comes the Grub-Shell. This enables you to find and boot different systems and files (i.e. Kernel) even with a faulty menu.lst.</p>

							<p>To do a little bit of testing, you can even run Grub from a booted system from within a root-shell with "grub". In the Grub-Shell you can see all possible commands with "help". Detailed help for each command is obtained with <span class="highlight-3">help command",</span> back to the Linux-Shell you go with "quit"( Grub-Shell is terminated). In the Grub-Shell the tab-key has a similar function as in the Linux-Shell, which is a great ease. Commands, Drivenames and Filenames can be auto-completed with the tab-key.</p>

							<p>Grub gives you the opportunity to locate the Kernel and the initrd even before the actual boot by "find" , e.g.with the following command</p>

<pre>
find /boot/vmlinuz
</pre>

							<p>Grub shows the partitions, that have a Kernel with the name "vmlinuz" in the directory "/boot":</p>

<pre>
(hd0,3) (hd1,0)
</pre>

							<p>All available partitions can be found with "geometry", e.g.</p>

<pre>
geometry (hd0)
</pre>

							<p>shows this:</p>

<pre>
"drive 0x80: C/H/S = 3648/255/63, The number of sectors = 58605120, /dev/hda Partition num: 0,
Filesystem type is fat, partition type 0xb Partition num: 1,
Filesystem type is fat, partition type 0xb Partition num: 2,
Filesystem type is fat, partition type 0xc Partition num: 4,
Filesystem type is ext2fs, partition type 0x83 Partition num: 5,
Filesystem type unknown, partition type 0x82 Partition num: 6,
Filesystem type is fat, partition type 0xb"
</pre>
							<p>After the Kernel or an existing initrd (or miniroot.gz) has been found, you can start with "boot".</p>


				<h3>Edit-Mode</h3>

							<p>This mode enables you to change entries in the "menu.lst" while booting. This works even when Grub is booted from CD and the menu.lst is write-protected . To do so you first hit ESC, confirm with Return and then hit "e". The parameters are then added to the end of the line or you move within the line with the Cursor-keys.</p>


				<h3>menu.lst (examples for possible entries)</h3>

							<p><span class="highlight-2">NOTE:</span> In this section commented out lines are started with <span class="highlight-3">2</span> or more <span class="highlight-3">#</span> marks, and are excluded from interfering with the bootprocess.</p>

<pre>
# Example /boot/grub/menu.lst
################################################
# setkey changes the keyboardlayout to german (as an example)
setkey y z
setkey z y
setkey Y Z
setkey Z Y
setkey equal parenright
setkey parenright parenleft
setkey parenleft asterisk
setkey doublequote at
setkey plus bracketright
setkey minus slash
setkey slash ampersand
setkey ampersand percent
setkey percent caret
setkey underscore question
setkey question underscore
setkey semicolon less
setkey less numbersign
setkey numbersign backslash
setkey colon greater
setkey greater bar
setkey asterisk braceright
# menu.lst - See: grub(8), info grub, update-grub(8)
#            grub-install(8), grub-floppy(8),
#            grub-md5-crypt, /usr/share/doc/grub
#            and /usr/share/doc/grub-doc/.

## default num
# Set the default entry to the entry number NUM. Numbering starts from 0, and
# the entry number 0 is the default if the command is not used.
default		0

## timeout sec
# Set a timeout, in SEC seconds, before automatically booting the default entry
# (normally the first entry defined).
timeout		5

# Pretty colours
color cyan/blue white/blue
gfxmenu (hd0,5)/boot/message

## password ['--md5'] passwd
# If used in the first section of a menu file, disable all interactive editing
# control (menu entry editor and command-line)  and entries protected by the
# command 'lock'
# e.g. password topsecret
#      password --md5 $1$gLhU0/$aW78kHK1QfV3P2b2znUoe/
# password topsecret

#
# examples
#
# title		Windows 95/98/NT/2000
# root		(hd0,0)
# makeactive
# chainloader	+1
#
# title		Linux
# root		(hd0,1)
# kernel	/vmlinuz root=/dev/hda2 ro
#

#
# Put static boot stanzas before and/or after AUTOMAGIC KERNEL LIST

### BEGIN AUTOMAGIC KERNELS LIST
## lines between the AUTOMAGIC KERNELS LIST markers will be modified
## by the debian update-grub script except for the default options below

## DO NOT UNCOMMENT THEM, Just edit them to your needs

## ## Start Default Options ##
## default kernel options
## default kernel options for automagic boot options
## If you want special options for specific kernels use kopt_x_y_z
## where x.y.z is kernel version. Minor versions can be omitted.
## e.g. kopt=root=/dev/hda1 ro
##      kopt_2_6_8=root=/dev/sdc1 ro
##      kopt_2_6_8_2_686=root=/dev/sdc2 ro
# kopt=root=UUID=1885d68b-cc9c-49f8-9f98-a6874e7b3e7e ro  quiet vga=791

## default grub root device
## e.g. groot=(hd0,0)
# groot=(hd0,5)

## should update-grub create alternative automagic boot options
## e.g. alternative=true
##      alternative=false
# alternative=false

## should update-grub lock alternative automagic boot options
## e.g. lockalternative=true
##      lockalternative=false
# lockalternative=false

## additional options to use with the default boot option, but not with the
## alternatives
## e.g. defoptions=vga=791 resume=/dev/hda5
# defoptions=

## should update-grub lock old automagic boot options
## e.g. lockold=false
##      lockold=true
# lockold=false

## Xen hypervisor options to use with the default Xen boot option
# xenhopt=

## Xen Linux kernel options to use with the default Xen boot option
# xenkopt=console=tty0

## altoption boot targets option
## multiple altoptions lines are allowed
## e.g. altoptions=(extra menu suffix) extra boot options
##      altoptions=(single-user) single
# altoptions=(single-user mode) single

## controls how many kernels should be put into the menu.lst
## only counts the first occurence of a kernel, not the
## alternative kernel options
## e.g. howmany=all
##      howmany=7
# howmany=all

## should update-grub create memtest86 boot option
## e.g. memtest86=true
##      memtest86=false
# memtest86=true

## should update-grub adjust the value of the default booted system
## can be true or false
# updatedefaultentry=false

## ## End Default Options ##

title		Debian GNU/Linux, kernel 2.6.22.1-slh-smp-7
root		(hd0,5)
kernel		/boot/vmlinuz-2.6.22.1-slh-smp-7 root=UUID=1885d68b-cc9c-49f8-9f98-a6874e7b3e7e ro  quiet vga=791
initrd		/boot/initrd.img-2.6.22.1-slh-smp-7

title		Debian GNU/Linux, kernel 2.6.22.1-slh-smp-7 (single-user mode)
root		(hd0,5)
kernel		/boot/vmlinuz-2.6.22.1-slh-smp-7 root=UUID=1885d68b-cc9c-49f8-9f98-a6874e7b3e7e ro  quiet vga=791 single
initrd		/boot/initrd.img-2.6.22.1-slh-smp-7

### END DEBIAN AUTOMAGIC KERNELS LIST

#### MS (TM)
title Windows 2K/XP/2003 (hda1)
chainloader (hd0,0)+1

### ISO boot
title sidux 32bit from gaiaISO
kernel (hd0,3)/sidux3/vmlinuz-2.6.22.1-slh-smp-7 boot=fll quiet vga=791 fromiso=/sidux3/siduxgaia.iso
initrd (hd0,3)/sidux3/initrd.img-2.6.22.1-slh-smp-7


title Debian GNU/Linux, kernel 2.6.18-1-686 (hda5)
root (hd0,4)
kernel (hd0,4)/boot/vmlinuz-2.6.18-1-686 root=/dev/hda5 ro vga=791
initrd (hd0,4)/boot/initrd.img-2.6.18-1-686
savedefault
</pre>

	</div>
	<div class="divider" id="dual-boot">
			<h2>Dual and Multiple Booting</h2>

							<p>To enable multiple grub OS booting is very simple with the use of chainloading. If for example you want to run a MS Windows (TM)  and Debian etch OS along with a sidux  'fromiso' installation , you will need to customise grub a bit, Therefore  edit the file <span class="highlight-3">/boot/grub/menu.lst </span>and add the following lines after the <span class="highlight-3">### END DEBIAN AUTOMAGIC KERNELS LIST</span>:</p>


<pre>
####MS Windows (TM) perhaps even MS Vista (TM)
title Windows (95/98/XP/Vista)
rootnoverify (hd0,1)
makeactive
chainloader +1

### Debian etch
title Debian etch
kernel (hd0,3)/debian/vmlinuz root=/dev/hda4 ro (or whatever)
initrd (hd0,3)/debian/miniroot.gz (or (whatever)

### ISO boot
title sidux 32bit from gaiaISO
kernel (hd0,3)/sidux3/vmlinuz-2.6.22.1-slh-smp-7 boot=fll quiet vga=791 fromiso=/sidux3/siduxgaia.iso
initrd (hd0,3)/sidux3/initrd.img-2.6.22.1-slh-smp-7
</pre>


							<p>Some people need/want several MS Windows (TM)Installations. MS Windows (TM) always wants to boot from disk 1. We will have to hide one partition and activate another. The following commands should be entered in the GRUB-Commandline and, if successfull, copied to the menu.lst. This should be done for every Windows-partition. Don't forget to do a Backup:</p>

<pre>hide (hd0,0) # hidden partition 1 of disk 1
unhide (hd0,1) # makes partition 2 of disk 1 visible
rootnoverify (hd0,1) # makes partition 2 of disk 1 the Root-FS
makeactive # makes partition 2 of disk 1 active
chainloader +1 # points to the first sector of the start-partition
boot # boots the operating system</pre>

							<p>If you want to start a 2nd Windows from the 2nd disk, you virtually swap disk 1 and 2. Thereby Windows sees a simulated 1st disk:</p>

<pre>
map (hd0) (hd1)
map (hd1) (hd0)
</pre>


					<h3>Pitfalls</h3>

							<p>As Grub has no 1024-cylinder barrier and can boot systems above 1024 cylinders, the  "/boot/grub/stage2" must be accessible by the bios (must be before 1024 cylinders). Stage2 may not be moved after installation (e.g. Defrag could try that). Setup data will get written that would not be congruent anymore. It is reasonable to make stage2 read-only (you must be in the current directory):</p>

<pre>
Dos: attrib +r +s stage2
LINUX: # chmod a -w ./stage2
</pre>


				<h3>Where to find out more</h3>



							<p><a href="http://www.gnu.org/software/grub/grub-faq.en.html">The official FAQ for Grub</a>.</p>

							<p>If you have a supported network card, Grub can boot over the network.<a href="http://os.inf.tu-dresden.de/%7Efm3/grub.html"> An appropriate Boot-Disk can be obtained here (allthough with an older version of Grub)</a>.</p>

	</div>

	<div id="rev">Content last revised 03/02/2010 1100 UTC</div>


</div>
</body>
</html>
